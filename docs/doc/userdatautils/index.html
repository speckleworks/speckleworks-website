
<html>
<head>
  <title>Speckle User Data Utils</title>
  <meta charSet="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="icon" type="image/png" href="https://speckle.works/img/logos/logo-xs.png">
  <link rel="apple-touch-icon" type="image/png" href="https://speckle.works/img/logos/2xlogo-white.png">
  <link rel="icon" sizes="144x144" href="https://speckle.works/img/logos/2xlogo-white.png">
  
  <link rel="stylesheet" type="text/css" href="/css/main.css">
  <link rel="stylesheet" href="/css/waffle-grid.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  
  <meta property="og:title" content="Speckle User Data Utils">
  <meta property="og:description" content="Delivering the Rich in Data Rich Design: create your own custom smart objects.">
  <meta property="og:image" content="https://speckle.works/img/userdata/header.png">
  <meta property="og:url" content="https://speckle.works/doc/userdatautils/">

  <meta name="twitter:site" content="@idid">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://speckle.works/img/userdata/header.png" />
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-96321582-1', 'auto');
  ga('send', 'pageview');
</script>
</head>
<body>
<div class="navigation-header">
  <div class="grid section-block m-hide main-nav-header">
    <div class="row">
      <div class="col col-12-of-12">
        <nav class="sidebar-nav">
            
          <a class="sidebar-nav-item" href="/">  Speckle</a>   
          <a class="sidebar-nav-item" href="/blog/">  Blog</a>     
          <a class="sidebar-nav-item" href="/about/">  About</a>   
          <a class="sidebar-nav-item" href="/doc/">  Docs</a>   
          <a class="sidebar-nav-item" href="https://slacker.speckle.works/"> <i class='fa fa-slack'></i> Slack</a>   
          <a class="sidebar-nav-item" href="https://github.com/speckleworks"> <i class='fa fa-github'></i> Github</a>  
        </nav>
      </div>
    </div>
  </div>
  <div class="mobile-button add-shadow m-and-lower" id="menubutton">
    <img src="/img/logos/logo-xs.png" style="height: 20px;">
  </div>
  <div id="mobilemenu" class="grid mobile-menu m-and-lower">
    <div class="mobile-button-close" id="menubuttonclose">
      <i class="fa fa-close"></i>
    </div>
    <div class="row">
      <div class="col col-12-of-12 center-me-wrap">
        <nav class="sidebar-nav" style="width: 100%;">
            
          <a class="sidebar-nav-item" href="/">  Speckle</a>   
          <a class="sidebar-nav-item" href="/blog/">  Blog</a>     
          <a class="sidebar-nav-item" href="/about/">  About</a>   
          <a class="sidebar-nav-item" href="/doc/">  Docs</a>   
          <a class="sidebar-nav-item" href="https://slacker.speckle.works/"> <i class='fa fa-slack'></i> Slack</a>   
          <a class="sidebar-nav-item" href="https://github.com/speckleworks"> <i class='fa fa-github'></i> Github</a>  
        </nav>
      </div>
    </div>
  </div>
</div>
<div></div>
<div class="m-hide" style="height: 42px; pointer-events: none;">
</div>
<div></div>

  <div class="header-img" style='background: url("/img/userdata/header.png") center center fixed  no-repeat'></div>
  
  <div class="article-title card-5">
    <h1>
      <strong>Speckle User Data Utils</strong>
    </h1>
    <subtitle>
      <p>
        <em>by <a href="https://twitter.com/idid" style='border: none; font-size: 16px;'>Dimitrie Stefanescu <i class='fa fa-twitter' style='color:#86AFFB'></i></a></em>
        <br>
        <small>3 min read. Posted on Tue, Apr 4, 2017</small>
      </p>
    </subtitle>
  </div>
  <div class="grid section-block article-block">
    <div class="row">
      
      <div class="col col-3-of-12 col-m-4-of-4 m-hide" >
          <div id='toc'>
          <h5>Contents</h5>
          <nav id="TableOfContents">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#creating-custom-properties">Creating Custom Properties</a></li>
<li><a href="#nested-properties-turtles-all-the-way-down">Nested Properties: Turtles All The Way Down</a></li>
<li><a href="#attaching-properties-to-geometry">Attaching Properties To Geometry</a></li>
<li><a href="#getting-properties-from-geometry">Getting Properties From Geometry</a></li>
<li><a href="#exporting">Exporting</a></li>
<li><a href="#baking-and-referencing">Baking and Referencing</a></li>
<li><a href="#sending-via-speckle">Sending via Speckle</a></li>
</ul>
</nav>
          </div>
      </div>
      <div class="col col-9-of-12 col-m-4-of-4 article">
        

<h1>Before you begin:</h1>

<p><strong>Download the custom user data utils from here: <a href='https://github.com/didimitrie/SpeckleUserDataUtils/tree/dev/releases'>https://github.com/didimitrie/SpeckleUserDataUtils/tree/dev/releases</a>. They are no longer bundled with the main Speckle Sender Receiver distribution, sorry!</strong>
</p>

<p>To use with Speckle, make sure you go through <a href="https://speckle.works/doc/grasshopperinstall/">the installation guide.</a></p>

<h1 id="introduction">Introduction</h1>

<p>The Speckle User Data Utilities deliver the &ldquo;Rich&rdquo; in the &ldquo;Data Rich Design&rdquo;. Similar to <a href="http://www.elefront.info/">Elefront</a> and other plugins that I might not know of, they allow you to easily define and attach a set of properties to geometry objects.</p>

<p>Objects with attached user data, if baked, will not loose it. As such, you can reference them again in Grasshopper and you will be able to retrieve that user data.</p>

<p>Furthermore, you can even send them through the Speckle Sender! When they come out on the other side, in a Speckle Receiver, they will have said user data attached to them.</p>

<p>In the background they work with Rhino&rsquo;s <a href="http://developer.rhino3d.com/api/RhinoCommonWin/html/T_Rhino_Collections_ArchivableDictionary.htm">ArchivableDictionary</a> class.</p>

<p>They are extremely simple to use.</p>

<h1 id="creating-custom-properties">Creating Custom Properties</h1>

<p><img src="/img/userdata/create.gif" alt="spk" /></p>

<p>The takeaways:</p>

<ul>
<li>the input parameter name becomes the object&rsquo;s key</li>
<li>the value of the input parameter becomes the object&rsquo;s value</li>
</ul>

<h1 id="nested-properties-turtles-all-the-way-down">Nested Properties: Turtles All The Way Down</h1>

<p>You can store three types of data: Numbers, Strings and <strong>Other Custom Properties.</strong></p>

<p><img src="/img/userdata/turtles.gif" alt="spk" /></p>

<p>This allows you to easily create nested properties and store object information in logical groups that you can create to suit your specific project needs. It&rsquo;s up to you.</p>

<h1 id="attaching-properties-to-geometry">Attaching Properties To Geometry</h1>

<p><img src="/img/userdata/AttachUserData.png" alt="spk" /></p>

<p>Using the <strong>Set User Data</strong> component, just plug in the objects you want attach data to and created properties.</p>

<h3>Baking User Data</h3>

<p>If you bake objects in Rhino with user data attached to them it will be serialised: when you reference them back into Grasshopper, you will be able to extract that user data.</p>

<h1 id="getting-properties-from-geometry">Getting Properties From Geometry</h1>

<p><img src="/img/userdata/GetUD.png" alt="spk" /></p>

<p>Using the <strong>Get User Data</strong> component, plug in the objects you want to extract the user data from and get out the dictionaries.</p>

<p>Once you got the User Data, use the <strong>Expand User Data</strong> to, well, get the properties out again. Note that if you use nested properties you will need to <strong>Expand User Data</strong> the respective nested property too.</p>

<p><img src="/img/userdata/filter.png" alt="spk" />
You can now filter your objects based on their properties using standard Grasshopper functionality.</p>

<h1 id="exporting">Exporting</h1>

<p>You have two options to export them: JSON and CSV.</p>

<h3>JSON Strings</h3>

<p>The most faithful representation. Straightforward, and nothing complicated:</p>

<pre><code>[
  {
    &quot;type&quot;: &quot;side_panel&quot;,
    &quot;centre&quot;: &quot;0.0, -8.0, 20.0&quot;,
    &quot;dist_attractor&quot;: 13.83970326936719,
    &quot;scale_factor&quot;: 0.53810463458171542,
    &quot;normal_vector&quot;: {
      &quot;x&quot;: -1.4791141972893965E-31,
      ...
    }
  },
  {
    &quot;type&quot;: &quot;hex_panel&quot;,
    &quot;scale_factor&quot;: 0.38469562983428035,
    &quot;material&quot;: &quot;reddish-like_glossy&quot;,
    &quot;otherProperty&quot;: { ... }
  },
  {...}
]
</code></pre>

<p>Note that you always get out an array of json objects.</p>

<h3>CSV</h3>

<p>When exporting to CSV, the JSON structure is essentially &ldquo;flattened&rdquo;. First row will always contain all the property keys. Following there&rsquo;s one row per object, with null values inserted where they don&rsquo;t correspond. Let&rsquo;s say you have the following UDs:</p>

<pre><code>[
    {
        X: 42,
        Y: {
            nested_1: &quot;hello&quot;,
            nested_2: &quot;world&quot;
        }
    },
    {
        random_prop: 123
    }
]
</code></pre>

<p>This will result in the following csv file:</p>

<pre><code>ROW 0: X, Y.nested_1, Y.nested_2, random_prop
ROW 1: 42, hello, world, null
ROW 2: null, null, null, 123
</code></pre>

<h1 id="baking-and-referencing">Baking and Referencing</h1>

<p>As mentioned above, if you bake your smart objects into Rhino proper, you will be able to retrieve the user data when you reference them again in grasshopper.</p>

<h1 id="sending-via-speckle">Sending via Speckle</h1>

<p>Objects that have user data attached to them can be sent through the Speckle Sender without loosing their &ldquo;smartness&rdquo;: the properties will remain attached to the object, and in the near future, you will be even able to directly query the Speckle Server based on them. Neat, no?</p>

<p>For a tutorial on how to send data via Speckle, <a href="/doc/senderreceiver">check this tutorial out!</a></p>

      </div>
      
    </div>
  </div>
  
  <div class="grid section-block article-block">
    <div class="row">
      <div class="col col-12-of-12 col-m-4-of-4">
        <h5>Having trouble? Found a bug? Have a question? Join the discussion below our join our <a href="https://slacker.speckle.works">slack channel.</a></h5> <div id='discourse-comments'></div>
<script type="text/javascript">
  DiscourseEmbed = { discourseUrl: 'https://discourse.speckle.works/',
                     discourseEmbedUrl: "https://speckle.works/doc/userdatautils/"
                   };

  (function() {
    var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true;
    d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d);
  })();
</script>
      </div>
    </div>
  </div>
   <div class="footer blue">
  <div class="grid">
  <br>
  <br>
  <br>
    <div class="row">
      <div class='col col-9-of-12 col-m-4-of-4'>

      <p class="xxsubheading">
        Get in touch on <a href="https://slacker.speckle.works/" style='border:none'><i class='fa fa-slack'></i> Slack</a>!
        <hr>
      </p>
      
      
      <p class="paragraph">
          This project has received funding from the European Union’s Horizon 2020 research and innovation program under the Marie Sklodowska-Curie grant agreement No 642877.
      </p>
      <br>
      <br>
      <br>
      <p class="paragraph"><small>© 2015 - 2018 <a href="http://dimitrie.org">Dimitrie Stefanescu</a>, <a href="https://www.ucl.ac.uk/bartlett/" class="href">UCL The Bartlett</a>, <a href="http://innochain.net/">InnoChain</a> & Project Contributors. <a href='http://twitter.com/idid'>i did</a> this.</small></p> 
      </div>
      <br>
      <br>
      <br>
      <br>
      <br>
      <div class="col col-3-of-12 text-right">
        <a class="logo-img" href="https://speckle.works"><img src="/img/logos/2xlogo-white.png" style="width: 75px;"> </a>
      </div>
    </div>
  </div>
</div>
<script async defer src="/js/scripts.js"></script>
</body>
</html>